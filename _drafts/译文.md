
AWS时代是从2006年3月4日亚马逊S3开始的，至今已经10年了。
回望过去的十年，在我们构建和运营安全、可靠、大规模和可预计性能的底本成本系统中学到了数百个经验教训。
鉴于AWS在世界范围内是构建和运营服务的先行者，这些经验教学对于我们的业务来说十分重要。
我们以前多次强调，经验教训没有压缩算法。
通过服务每月一百万活跃用户，同时他们服务数百万他们的用户，我们不缺少获得这些经验机会，同时可能这是我们持续改进用户服务最好的环境。

我选了一些经验教训来与大家分享，希望对这些对大家同样有用。

1.  构建可进化的系统

    几乎从第一天开始，我们就知道我们构件的软件不是一年后运行的软件。
    这个预期是基于，在每一个订单或两个数量级之间，我们需要重新审视和修改架构，以确保我们可以处理大规模的问题。
    
    但是我们没有采用通过暂停服务运营来升级系统的老方式，因为全世界大量的业务需要依赖我们平台7*24小时不间断服务。
    我们需要构建一个不停止服务就可以增加新组件的架构。
    有一次亚马逊的工程师Marvin Theimer开玩笑说，
    Amazon S3的进化好比一架已经起飞的单引擎Cessna飞机，一会升级为一架737飞机，然后是一组747飞机，现在是空客A380机队。
    一路走来，我们在乘客毫无察觉的情况下，进行空中加油、把乘客从一架飞机换到另一架飞机。

2.  期待意外

    失败是一个礼物。
    从路由器到磁盘，从操作系统到TCP包的内存错误，从临时的错误到无法修复失败，所有事情总会遇到失败。
    无论你使用高质量的硬件还是低成本的组件，都无法避免。
    
    这对于大规模的系统是很重要的经验。
    举个例子，S3处理亿万级的存储事务，任何可能性极低的错误都会发生。
    许多失败的场景可以预计，但是许多错误在设计和构建系统的时候不可能预料到。
    
    我们需要构建能自然容错的系统，即使我们不知道可能会是什么错误。
    即使后院起火，系统仍然能运行。
    在不完全停机的情况下处理崩溃是很重要的。
    我们已经开发了即使大范围失败发生仍然能使整体系统正常运行的基本能力

3.  基本功能非框架

    服务运营早期我们开始认识到，当用户使用我们系统的时候，他们工作已经在开始了。
    当用户离开旧时代IT硬件和数据中心的约束后，他们开始开发新的系统和有趣的使用模型。
    因此，我们需要非常敏捷，确保我们能满足顾客的需求。
    
    我们提供的一个非常重要的机制是给予用户一系列基本功能和工具。
    他们可以选择合适方式来使用AWS云。
    而不是提供一个大而全的框架强迫用户使用。
    这个方案使我们的顾客获得了成功，后来我们根据客户习惯的基本功能组合产生了AWS服务。
    
    另外一个很重要的认识是，很难预测用户特定需求。
    直到他们开始使用你的服务，并在上面进行相关开发，你才会有所了解。
    这就是为什么我们使用最基本的功能集合提供新的服务，允许用户推动扩展系统新特性的路线图。
    
4.  自动化很关键

    开发用于运营的软件服务和开发卖给用户使用的软件不同。
    管理大规模系统要求有不一样的观念，确保用户预期的可靠性、高性能和可拓展性得到满足。
    
    关键的机制是尽可能的自动化，处理潜在的错误、避免人工操作。
    因此，我们需要开发控制关键功能的管理API。
    AWS同样帮助客户做到自动化。
    把你的应用分解到核心构建模块，每一个模块都有管理API，你可以使用自动化规则来维护大规模系统的可靠性和预计的性能。
    有一个很好的石蕊测试，如果你需要SSH到服务器或者云实例，那么你自动化的程度还不够。
    
5.  API不可变

    这是我们从亚马逊零售业务获得的重要经验。
    但对于AWS的API化的业务更加重要。
    一旦用户使用我们的API开始构建他们的应用和服务，改变这些API就不可能的。
    如果我们这样做会对客户运营中的业务产生非常大的影响。
    我们认为API的设计是很重要的工作，因为我们只有一次机会就要做到成功。
  
6.  清楚你的资源使用率

    当为系统构建经济模型来抽象合适的收费模型，就要确保你有服务成本和运营的详细数据 ，尤其是在高负荷下运行的数据。
    作为服务提供商，AWS需要非常清楚自己的成本。
    只有这样我们才能承担我们提供给用户的服务，明确我们今后提高效率优化成本的领域，然后为客户提供更加便宜的服务。
    
    早期的一个例子，当时我们不明确运营S3所需要的资源，我们只是推测我们需要对提供的磁盘和带宽资源进行收费。
    在运行一段时间后，我们认识到大量的网络请求同样是重要资源。
    如果客户有大量的小文件，即使他们发起了上百万个网络请求，磁盘和带宽也不会消耗太多，
    我们必须调整所有资源使用率的计费模型 ，AWS才能继续运营。
  
7.  从头到尾关注安全

    保护你的用户一直都是优先级最高的工作。
    对于AWS也一样。
    从运营的观点，以及工具和机制，安全一直都是我们首要投入的领域。
    
    我们最早学到的方法是构建安全的服务。
    有必要在开始设计系统的时候很考虑到安全方面。
    安全团队的工作并不是在系统构建好后进行评估。
    他们开始就是合作者，确保底层架构从到头尾的安全。
    对于安全问题不能有任何妥协。
    
8.  加密是头等居民

    加密机制对于用户是非常关键的。
    加密机制可以确保用户数据的访问完全受他们控制。
    对于用户来说，加密是确保用户数据的访问完全在他们控制下的关键机制。
    十年前，加密的工具和服务是难使用。
    直到近几年，经过我们的运营，我们知道如何用最好的方式将加密集成到我们的服务中。
    
    S3要求用户遵守使用案例，开始提供服务端加密。
    如果你能查看我们数据中心的磁盘，你会发现并不能获得任何数据。
    但是通过使用亚马逊CloudHSM和后来的亚马逊密钥管理服务，客户可以使用他们的密钥加密，而不需要亚马逊来管理他们的密钥。
    
    最近，在每个新系统的设计阶段就集成了加密模块。
    举个例子，在亚马逊Redshift，每个数据块都使用了默认的随机密钥加密。
    同时这些随机密钥会被主密钥加密。
    主密钥可以由客户提供，这样就可以确保他们是唯一能解密，并访问他们关键运营数据或者个人私密信息的人。
    
    在我们的业务中，加密一直都是处于高优先级。
    我们会继续使客户使用加密更加易用，这样他们能更好的保护他们自己和他们的客户。
    
9.  网络的重要性

    AWS已经支持不同的负载，从大量的事务处理到大规模视频传输编码，从高性能并发计算到大量网站访问。
    每一个不同的负载都有唯一需求，当他需要网络的时候。
    
    AWS已经开发了一个独特的能力，更新数据中心布局和运行。
    这样我们就拥有满足不同客户负载需求的弹性网络基础设施。
    我们一直认为我们不能害怕去开发我们自己的能满足客户需求的硬件解决方案。
    这是我们完成了是否详细的需求。类似在网络层隔离AWS客户的能力，这样达到更高级别的安全。
    
    另一个成功的例子是AWS设计的网络硬件和软件怎么使我们更近一步提供性能，为我们的客户在虚拟机网络访问时计算虚拟费用。
    因为网络访问是共享资源，用户以前总会对网络资源感觉紧张。
    开发支持单root虚拟IO的NIC，使我们能给每一台虚拟机自己虚拟化的NIC。
    这个延迟比原来减少了2倍，分发能力比原来提高了10倍。
    
10. 没有门卫

    随着时间的推移，AWS团队已经交付许多服务和特性为我们的用户建立了广而深的平台。
    但是AWS不仅仅有我们内建的服务，我们的合作伙伴交付的服务将AWS构建成一个丰富的生态系统，将这个平台向许多新的方向拓展。
    
    举个例子，我们的合作伙伴Stripe在AWS上为Twilio的电信程控系统提供计费服务。
    许多用户在AWS上构建了服务于特定垂直需求的平台：
    Philips为管理健康数据构建了他们健康套件数字平台、
    Ohpen在AWS上构建了小额银行业务平台、
    Eagle Genomics构建了基因组处理平台等等。
    核心是在AWS平台没有门卫告诉我们的合作伙伴什么能做什么不能做。
    “No gatekeepers”解放了创新工艺，开启了惊人的创造力之门。
    这是一定要遵循。


